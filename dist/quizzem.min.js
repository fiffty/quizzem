"use strict";function qzm(a,b,c){function d(d,e,f,g){function h(){switch(d.mode){case"javascript":i();break;case"html":j()}}function i(){d.showError=!1;var b=d.code+"\n"+d.testCode,c=quizzemWebWorker.toString();c=c.substring(c.indexOf("{")+1,c.lastIndexOf("}"));var e=new Blob([c],{type:"application/javascript"}),f=new Worker(URL.createObjectURL(e));f.postMessage(b);var g=a.defer();f.onmessage=function(a){g.resolve(a.data),f.terminate()},g.promise.then(function(a){(d.errorInUserCode=a.error[0])?d.showError=!0:(d.currentStep==d.maxStep&&d.maxStep++,d.currentStep<d.inputTests.length-1&&l(n,++d.currentStep)),d.outputResult={currentStep:d.currentStep,maxStep:d.maxStep,totalSteps:d.totalSteps}})}function j(){d.showHTML=!d.showHTML,d.showHTML?d.htmlBtn="Show HTML":d.htmlBtn="Show Output"}function k(a){}function l(a,b,c){return c&&d.currentStep==d.maxStep&&d.currentStep==b?h():(d.code=d.inputTests[b].startingCode||d.code||"",a.setValue(d.code),d.testCode=d.inputTests[b].testCode,void(d.currentStep=b))}function m(){if(n){var a=n.getWrapperElement();a.parentNode.removeChild(a),n=null}d.inputTests.length>1&&(d.hasManySteps=!0);var b=d.inputOptions.codemirrorOptions;"html"==b.mode&&(b.mode="htmlmixed",d.$watch(function(){return d.code},function(a){d.htmlcode=c.trustAsHtml(a)})),n=new CodeMirror(document.getElementById("qzm-codemirror"),b),d.codemirror=n,n.on("change",function(a){d.code=a.getValue()})}if(angular.isUndefined(CodeMirror))throw new Error("Quizzem needs CodeMirror to work.");d.mode=d.inputOptions.codemirrorOptions.mode,d.checkWork=h,d.codemirrorLoaded=k,d.goToStep=l,d.htmlBtn="Show Output",d.currentStep=0,d.maxStep=0,d.totalSteps=d.inputTests.length,d.outputResult={currentStep:d.currentStep,maxStep:d.maxStep,totalSteps:d.totalSteps},d.showError=!1;var n;d.$watch(function(){return d.inputTests},function(a){a&&b(function(){m(),l(n,0)})})}return{templateUrl:templatePath,restrict:"EA",scope:{inputOptions:"=qzmOptions",inputTests:"=qzmTests",inputRefreshState:"=qzmRefreshState",outputResult:"=qzmResult"},link:d}}function quizzemWebWorker(){!function(){function a(a){var b=this;b.did={console:{log:[]},angular:{module:[],moduleArray:[],controller:[],controllerFunc:[],service:[],serviceFunc:[],filter:[],filterFunc:[]}},b.console={log:function(a){b.did.console.log.push(a)}};var c=function(b,c,d){b&&c?"string"!=typeof b?a.error.push("The first parameter for "+d+" must be a string."):"function"!=typeof c&&a.error.push("The second parameter for "+d+" must be a function."):a.error.push(d+" method needs two parameters when initiating an app.")};b.angular={module:function(c,d){return c&&d?"string"!=typeof c?a.error.push("The first parameter for angular.module() must be a string."):"object"!=typeof d&&a.error.push("The second parameter for angular.module() must be an array."):a.error.push("angular.module() method needs two parameters when initiating an app."),a.error[0]||(b.did.angular.module.push(c),b.did.angular.moduleArray.push(d)),b.angular.module=b.angular.moduleGetter,b.angular},moduleGetter:function(c){return"string"!=typeof c&&a.error.push("The parameter for angular.module() must be a string."),a.error[0]||b.did.angular.module.push(c),b.angular},controller:function(d,e){return c(d,e,".controller()"),a.error[0]||(b.did.angular.controller.push(d),b.did.angular.controllerFunc.push(e)),b.angular},service:function(d,e){return c(d,e,".service()"),a.error[0]||(b.did.angular.service.push(d),b.did.angular.serviceFunc.push(e)),b.angular},filter:function(d,e){return c(d,e,".filter()"),a.error||(b.did.angular.filter.push(d),b.did.angular.filterFunc.push(e)),b.angular}},b.process={argv:["node","app.js","1","2","hello","4"]}}var b=postMessage,c=addEventListener;!function(a){var b=a,c=["Object","Function","Infinity","NaN","undefined","Array","Boolean","Number","String","Symbol","Map","Math","Set","isNaN","caches","TEMPORARY","PERSISTENT"];do Object.getOwnPropertyNames(b).forEach(function(a){-1===c.indexOf(a)&&delete b[a]}),b=Object.getPrototypeOf(b);while(b!==Object.prototype)}(this),c("message",function(c){var d={error:[]};a(d);var e=new Function(c.data);try{var f=e();0==f[0]?d.error.push(f[1]):d.success=f[1]}catch(g){d.error.push(g.toString())}b(d)})}()}var scripts=document.getElementsByTagName("script"),currentScriptPath=scripts[scripts.length-1].src;if("min.js"==currentScriptPath.slice(-6))var templatePath=currentScriptPath.replace("quizzem.min.js","quizzem.html");else var templatePath=currentScriptPath.replace("quizzem.js","quizzem.html");angular.module("quizzem",[]).directive("qzm",["$q","$timeout","$sce",qzm]);